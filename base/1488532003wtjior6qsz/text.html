<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:17px; margin-right:190px; -qt-block-indent:0; text-indent:0px;">В составе дистрибутива есть 2 версии заббикса:<br />zabbix-server-mysql<br />zabbix-server-pgsql</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:17px; margin-right:190px; -qt-block-indent:0; text-indent:0px;">Но если нет внешнего mysql сервера то вариант с мускулем не подходит,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:17px; margin-right:190px; -qt-block-indent:0; text-indent:0px;">потому что:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:190px; -qt-block-indent:0; text-indent:0px;">&quot;<span style=" font-family:'helvetica'; font-size:16px; color:#44a9cf; background-color:#ffffff;">в целях оптимизации состава операционной системы Astra Linux Special Edition из дистрибутива исключен ряд дублирующих друг друга компонент, решающих сходные целевые задачи. Например, из двух СУБД MySQL и PostgreSQL, входящих в состав Astra Linux Common Edition, в дистрибутив операционной системы Astra Linux Special Edition включена СУБД PostgreSQL&quot;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:190px; -qt-block-indent:0; text-indent:0px; font-family:'helvetica'; font-size:16px; color:#44a9cf;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">помним что при установке:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">&quot;[info] zabbix_server is disabled in /etc/default/zabbix-server&quot;</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Настройка СУБД:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">usermod -a -G shadow postgres</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">setfacl -d -m u:postgres:r /etc/parsec/macdb</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">setfacl -R -m u:postgres:r /etc/parsec/macdb</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">setfacl -m u:postgres:rx /etc/parsec/macdb</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">service postgresql restart</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">adduser zabbixdb</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">{ </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">вероятно может потребоваться:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">usermod -a -G shadow zabbixdb</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">setfacl -d -m u:zabbixdb:r /etc/parsec/macdb</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">setfacl -R -m u:zabbixdb:r /etc/parsec/macdb</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">   setfacl -m u:zabbixdb:rx /etc/parsec/macdb</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">}</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">su postgres</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">psql template1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">CREATE USER zabbixdb WITH PASSWORD '11111111';</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">CREATE DATABASE zabbix;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">GRANT ALL PRIVILEGES ON DATABASE zabbix to zabbixdb;</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">! В качестве имени пользователя нельзя использовать имя user !</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">проверка:<br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">su zabbixdb</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">cd</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">psql -d zabbix</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">zabbix=&gt; \l</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">zabbix=&gt; \q</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для управления и просмотра нужно ставить вебморду:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">apt-get install zabbix-frontend-php</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">копируем конфиг и делаем линк:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">cd /usr/share/doc/zabbix-frontend-php/examples/apache.conf /etc/apache2/sites-available/zabbix.conf</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">ln -s /etc/apache2/sites-available/zabbix.conf /etc/apache2/sites-enabled/zabbix.conf</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">добавляем в него строки:<br />&lt;Directory /usr/share/zabbix&gt;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                AuthPAM_Enabled on</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                AuthType Basic</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                AuthName &quot;PAM authentication&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                require valid-user</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                Options Indexes FollowSymLinks MultiViews</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                AllowOverride None</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                Order allow,deny</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                allow from all</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">&lt;/Directory&gt;</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">php_value max_execution_time 300</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">php_value memory_limit 128M</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">php_value post_max_size 16M</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">php_value upload_max_filesize 2M</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">php_value max_input_time 300</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">php_value date.timezone Europe/Moscow</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">перегружаем:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">service apache2 reload</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">После этого можно зайти на </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">http://адрессайта/zabbix</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">и продолжить настройку.</p></body></html>